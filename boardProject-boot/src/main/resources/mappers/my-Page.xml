<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.kh.project.myPage.mapper.MypageMapper">

<update id="updateInfo">
UPDATE "MEMBER" 
SET 
MEMBER_NICKNAME = #{memberNickname}, 
MEMBER_ADDRESS = #{memberAddress}, 
MEMBER_TEL = #{memberTel}
WHERE MEMBER_NO = ${memberNo}
</update>

<select id="selectPw" resultType="string" parameterType="_int">
SELECT MEMBER_PW
FROM "MEMBER"
WHERE MEMBER_NO = ${memberNo}
</select>

<update id="changePw">

UPDATE "MEMBER"
SET
MEMBER_PW = #{encPw}
WHERE MEMBER_NO = ${memberNo}

</update>

<update id="deleteConfirm">

UPDATE "MEMBER" SET
MEMBER_DEL_FL = 'Y'
WHERE MEMBER_NO = ${memberNo}


</update>

<insert id="insertUploadFile" parameterType="edu.kh.project.myPage.model.dto.UploadFile">

INSERT INTO "UPLOAD_FILE"
VALUES(
SEQ_FILE_NO.NEXTVAL, 
#{filePath}, 
#{fileOriginalName}, 
#{fileRename}, 
DEFAULT, 
${memberNo})

</insert>

<!-- 파일 목록 조회 -->
<select id="fileList" resultType="edu.kh.project.myPage.model.dto.UploadFile">

SELECT FILE_NO, FILE_PATH, FILE_ORIGINAL_NAME, FILE_RENAME, TO_CHAR(FILE_UPLOAD_DATE, 'YYYY-MM-DD') FILE_UPLOAD_DATE, MEMBER_NO, MEMBER_NICKNAME 
FROM "UPLOAD_FILE"
JOIN "MEMBER" USING(MEMBER_NO)
ORDER BY FILE_NO DESC

</select>

<update id="profile">

UPDATE "MEMBER" SET
PROFILE_IMG = #{profileImg}
WHERE MEMBER_NO = ${memberNo}

</update>


</mapper>
